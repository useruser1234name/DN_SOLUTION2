# Django Admin 설정 및 관리 가이드

## 1. Django Admin 개요

Django Admin은 DN_solution의 데이터베이스를 관리하기 위한 웹 기반 관리 인터페이스입니다. 업체, 사용자, 승인 상태 등을 효율적으로 관리할 수 있습니다.

### 1.1 접속 정보
- **URL**: `http://your-domain:8000/admin/`
- **기본 계정**: admin / admin1234

### 1.2 주요 기능
- 업체 및 사용자 관리
- 승인 상태 관리
- 데이터 조회 및 수정
- 권한 관리

## 2. 모델별 관리

### 2.1 업체 관리 (Companies)

#### 목록 보기
- **업체명**: 업체의 정식 명칭
- **업체 타입**: 본사/협력사/판매점
- **운영 상태**: 운영중/중단
- **노출 여부**: 하부 업체 노출 여부
- **소속 사용자**: 해당 업체에 소속된 사용자 수

#### 상세 관리
- **기본 정보**: 업체명, 타입, 상위 업체
- **운영 설정**: 운영 상태, 노출 여부, 기본 택배사
- **추가 정보**: 생성일시, 수정일시, 소속 사용자 목록

#### 주요 기능
- **상위 업체 설정**: 계층 구조 설정
- **상태 토글**: 운영 상태 변경
- **사용자 관리**: 소속 사용자 조회

### 2.2 사용자 관리 (Company Users)

#### 목록 보기
- **사용자명**: 로그인에 사용되는 사용자명
- **소속 업체**: 사용자가 속한 업체
- **역할**: 관리자/직원
- **승인 상태**: 승인됨/승인 대기/거절됨
- **마지막 로그인**: 최근 로그인 시간

#### 상세 관리
- **기본 정보**: 사용자명, 비밀번호, 소속 업체
- **권한 설정**: 사용자 역할
- **승인 상태**: 승인 여부, 승인 상태
- **활동 정보**: 마지막 로그인, 생성일시

#### 주요 기능
- **승인 관리**: 승인 상태 변경
- **비밀번호 관리**: 비밀번호 설정
- **역할 설정**: 관리자/직원 역할 변경

### 2.3 메시지 관리 (Company Messages)

#### 목록 보기
- **메시지 내용**: 발송된 메시지 미리보기
- **발송 타입**: 일괄/개별 발송
- **수신 업체**: 메시지 수신 업체
- **발송자**: 메시지 발송자
- **발송일시**: 메시지 발송 시간

#### 상세 관리
- **메시지 내용**: 전체 메시지 내용
- **발송 설정**: 일괄/개별 발송, 수신 업체, 발송자
- **발송 정보**: 발송일시, 메시지 ID

## 3. 승인 시스템 관리

### 3.1 승인 상태 필드

#### 승인 여부 (is_approved)
- **True**: 승인됨
- **False**: 대기/거절

#### 승인 상태 (status)
- **pending**: 승인 대기
- **approved**: 승인됨
- **rejected**: 거절됨

### 3.2 승인 프로세스

1. **사용자 생성**: 회원가입 시 자동으로 pending 상태로 생성
2. **승인자 확인**: 상위 업체 관리자가 승인 권한 확인
3. **승인 처리**: 승인 여부와 승인 상태 동시 변경
4. **로그인 허용**: 승인된 사용자만 로그인 가능

### 3.3 승인 권한

#### 본사 관리자
- 모든 사용자 승인 가능
- 모든 업체의 사용자 관리 가능

#### 협력사 관리자
- 자신의 하위 판매점 사용자만 승인 가능
- 자신의 업체 사용자만 관리 가능

#### 판매점 사용자
- 승인 권한 없음
- 자신의 정보만 조회 가능

## 4. 데이터 필터링 및 검색

### 4.1 업체 필터링
- **업체 유형**: 본사/협력사/판매점
- **운영 상태**: 운영중/중단
- **노출 여부**: 노출/숨김
- **생성일시**: 날짜 범위

### 4.2 사용자 필터링
- **역할**: 관리자/직원
- **소속 업체**: 특정 업체
- **승인 상태**: 승인됨/대기/거절
- **생성일시**: 날짜 범위

### 4.3 검색 기능
- **업체명**: 업체명으로 검색
- **사용자명**: 사용자명으로 검색
- **업체 코드**: 업체 코드로 검색

## 5. 권한 관리

### 5.1 Django User 권한
- **슈퍼유저**: 모든 권한
- **스태프**: 관리 사이트 접근 권한
- **일반 사용자**: 제한된 권한

### 5.2 CompanyUser 권한
- **관리자**: 업체 내 모든 권한
- **직원**: 제한된 권한

### 5.3 업체별 권한
- **본사**: 모든 업체 관리 가능
- **협력사**: 자신과 하위 업체만 관리 가능
- **판매점**: 자신의 업체만 관리 가능

## 6. 데이터 내보내기/가져오기

### 6.1 데이터 내보내기
- **CSV 형식**: 표 데이터 내보내기
- **JSON 형식**: API 데이터 내보내기
- **Excel 형식**: 스프레드시트 형식 내보내기

### 6.2 데이터 가져오기
- **일괄 업로드**: CSV 파일을 통한 일괄 데이터 입력
- **API 연동**: 외부 시스템과의 데이터 연동
- **수동 입력**: 개별 데이터 수동 입력

## 7. 로그 및 모니터링

### 7.1 활동 로그
- **사용자 생성/수정/삭제**: 모든 사용자 관련 활동 기록
- **업체 생성/수정/삭제**: 모든 업체 관련 활동 기록
- **승인 활동**: 승인/거절 활동 기록

### 7.2 시스템 모니터링
- **로그인 시도**: 성공/실패 로그인 시도 기록
- **API 호출**: 모든 API 호출 기록
- **오류 로그**: 시스템 오류 및 예외 상황 기록

## 8. 보안 설정

### 8.1 접근 제어
- **IP 제한**: 특정 IP에서만 접근 허용
- **세션 관리**: 세션 타임아웃 설정
- **2FA**: 2단계 인증 설정

### 8.2 데이터 보호
- **비밀번호 암호화**: 모든 비밀번호 해시화 저장
- **개인정보 보호**: 민감한 정보 마스킹
- **백업**: 정기적인 데이터 백업

## 9. 문제 해결

### 9.1 일반적인 문제

#### 승인 상태가 변경되지 않는 경우
1. **권한 확인**: 승인 권한이 있는지 확인
2. **상위 업체 관계 확인**: 업체 계층 구조 확인
3. **캐시 클리어**: 브라우저 캐시 삭제

#### 사용자가 로그인할 수 없는 경우
1. **승인 상태 확인**: 승인 여부와 상태 확인
2. **비밀번호 확인**: 비밀번호 정확성 확인
3. **계정 상태 확인**: 계정 활성화 상태 확인

#### 데이터가 보이지 않는 경우
1. **필터 확인**: 적용된 필터 확인
2. **권한 확인**: 해당 데이터에 대한 접근 권한 확인
3. **페이지 새로고침**: 브라우저 새로고침

### 9.2 성능 최적화

#### 데이터베이스 최적화
- **인덱스 설정**: 자주 조회되는 필드에 인덱스 설정
- **쿼리 최적화**: N+1 쿼리 문제 해결
- **캐싱**: 자주 사용되는 데이터 캐싱

#### 페이지 로딩 최적화
- **페이지네이션**: 대용량 데이터 페이지네이션
- **지연 로딩**: 필요할 때만 데이터 로딩
- **압축**: 정적 파일 압축

## 10. 추가 설정

### 10.1 커스텀 관리 명령어
```bash
# 초기 관리자 생성
python manage.py create_initial_admin

# 기존 사용자 일괄 승인
python manage.py approve_existing_users

# 특정 사용자 승인
python manage.py approve_specific_user --username username

# 데이터 정리
python manage.py cleanup_data --confirm
```

### 10.2 환경 설정
- **DEBUG**: 개발/운영 환경 설정
- **DATABASE**: 데이터베이스 연결 설정
- **SECRET_KEY**: 보안 키 설정
- **ALLOWED_HOSTS**: 허용된 호스트 설정

### 10.3 백업 설정
- **자동 백업**: 정기적인 데이터베이스 백업
- **백업 보관**: 백업 파일 보관 기간 설정
- **복구 테스트**: 백업 복구 테스트 정기 수행 