# 프론트엔드 설계 (Frontend Design)

이 문서는 `DN_solution` 프로젝트의 프론트엔드 애플리케이션 설계에 대한 상세 내용을 다룹니다. 사용자 인터페이스(UI)의 구성, 사용자 경험(UX) 원칙, 백엔드 API와의 연동 방식, 그리고 사용자 역할에 따른 UI 접근 제어 전략에 초점을 맞춥니다.

## 1. 아키텍처 및 기술 스택

### 1.1. 현재 구현된 프론트엔드

*   **아키텍처:** Django 템플릿 기반의 서버 사이드 렌더링 (SSR)
*   **프레임워크:** Django 5.2 템플릿 시스템
*   **UI 라이브러리:** Bootstrap 5, Font Awesome 6.0.0
*   **JavaScript:** 바닐라 JavaScript, AJAX (fetch API)
*   **CSS:** 커스텀 CSS + Bootstrap 클래스
*   **상태 관리:** Django 세션 기반 사용자 상태 관리
*   **라우팅:** Django URL 라우팅 시스템

### 1.2. 향후 확장 방향 (SPA)

*   **아키텍처:** SPA(Single Page Application) 아키텍처를 기반으로 하며, 컴포넌트 기반 개발을 통해 재사용성과 유지보수성을 극대화합니다.
*   **프레임워크/라이브러리:** React, Vue.js, 또는 Angular 중 하나를 선택하여 개발합니다.
*   **상태 관리:** 선택된 프레임워크에 맞는 전역 상태 관리 라이브러리 (예: Redux, Vuex, NgRx)를 사용하여 애플리케이션의 복잡한 상태를 효율적으로 관리합니다.
*   **UI 라이브러리/디자인 시스템:** Material-UI, Ant Design, Vuetify, Angular Material 등 검증된 UI 컴포넌트 라이브러리를 활용하여 개발 속도를 높이고 일관된 디자인을 유지합니다.
*   **라우팅:** 프레임워크에 내장된 라우터 (예: React Router, Vue Router, Angular Router)를 사용하여 클라이언트 측 라우팅을 구현합니다.
*   **API 통신:** `axios` 또는 `fetch` API를 사용하여 백엔드 RESTful API와 비동기적으로 통신합니다.

## 2. UI/UX 원칙

*   **사용자 중심 디자인:** 각 사용자 역할(슈퍼계정, 본사, 협력사, 판매점)의 니즈와 워크플로우를 이해하고, 그에 최적화된 UI를 제공합니다.
*   **직관적인 내비게이션:** 사용자가 시스템 내에서 자신의 위치를 쉽게 파악하고, 필요한 기능에 빠르게 접근할 수 있도록 명확하고 간결한 내비게이션 구조를 설계합니다.
*   **일관성:** 애플리케이션 전반에 걸쳐 시각적 디자인, 상호작용 패턴, 용어 사용에 일관성을 유지하여 학습 곡선을 줄이고 사용성을 높입니다.
*   **피드백:** 사용자 액션에 대한 즉각적이고 명확한 시각적 피드백(로딩 인디케이터, 성공/오류 메시지, 유효성 검증 피드백)을 제공합니다.
*   **반응형 디자인:** 다양한 디바이스(데스크톱, 태블릿, 모바일) 및 화면 크기에서 최적의 레이아웃과 사용자 경험을 제공하도록 유연하게 설계합니다.

## 3. 현재 구현된 정책 관리 인터페이스

### 3.1. 정책 목록 페이지 (`policy_list.html`)

*   **필터링 시스템:**
    *   검색 필드: 정책 제목 또는 설명으로 검색
    *   신청서 타입 필터: 드롭다운 선택
    *   통신사 필터: SKT, KT, LG U+ 등
    *   가입기간 필터: 12개월, 24개월 등
    *   노출 상태 필터: 노출/비노출
    *   프리미엄 마켓 필터: 노출/비노출
*   **정책 테이블:**
    *   정책 제목, 신청서 타입, 통신사, 가입기간
    *   대리점/판매점 리베이트 금액
    *   토글 스위치: 노출 상태, 프리미엄 마켓 노출
    *   배정 업체 수 표시
    *   액션 버튼: 상세보기, 수정, HTML 재생성, 삭제
*   **실시간 기능:**
    *   AJAX 기반 토글 스위치 상태 변경
    *   HTML 재생성 버튼
    *   실시간 메시지 표시 (성공/오류)
*   **페이지네이션:** Bootstrap 스타일 페이지네이션

### 3.2. 정책 생성/수정 폼 (`policy_form.html`)

*   **단계별 입력 섹션:**
    *   **기본 정보:** 정책 제목, 설명 (필수 입력)
    *   **신청서 설정:** 신청서 타입 선택
    *   **필터링 설정:** 통신사, 가입기간 선택
    *   **리베이트 설정:** 대리점/판매점 리베이트 금액
    *   **노출 설정:** 프론트엔드 노출, 프리미엄 마켓 노출 체크박스
*   **실시간 중복 체크:**
    *   정책 제목 입력 시 중복 체크 버튼
    *   AJAX 기반 실시간 검증
    *   결과 표시 (성공/오류)
*   **클라이언트 사이드 유효성 검증:**
    *   필수 필드 검증
    *   실시간 오류 메시지 표시
    *   폼 제출 시 로딩 상태 표시

### 3.3. 디자인 시스템

*   **색상 팔레트:**
    *   Primary: #007bff (Bootstrap blue)
    *   Success: #28a745 (Bootstrap green)
    *   Danger: #dc3545 (Bootstrap red)
    *   Secondary: #6c757d (Bootstrap gray)
*   **컴포넌트:**
    *   **토글 스위치:** CSS 기반 커스텀 토글 스위치
    *   **버튼:** Bootstrap 스타일 버튼 (primary, secondary, success, danger, outline)
    *   **카드:** Bootstrap 카드 컴포넌트
    *   **테이블:** 반응형 테이블 디자인
    *   **폼:** Bootstrap 폼 스타일링
*   **아이콘:** Font Awesome 6.0.0 아이콘 사용

## 4. UI 접근 제어 전략 (사용자 역할 기반)

프론트엔드 애플리케이션은 백엔드에서 이미 제어되는 권한을 시각적으로 반영하고, 사용자에게 불필요한 기능이나 정보를 노출하지 않음으로써 사용자 경험을 개선하고 보안을 강화합니다.

### 4.1. 핵심 원칙

*   **백엔드 권한(Authorization)이 최우선:** UI 레벨의 제어는 사용자 경험을 위한 것이며, 악의적인 사용자가 UI를 우회하여 직접 API 요청을 보낼 수 있으므로, **백엔드에서의 철저한 권한 검증은 필수적**입니다.
*   **역할 기반 제어:** 사용자의 역할 정보를 기반으로 UI 요소를 조건부로 렌더링하거나, 라우팅 접근을 제어합니다.

### 4.2. 구현 방식

*   **인증 후 역할 정보 획득:**
    *   사용자 로그인 성공 시, Django 세션에 사용자의 역할 정보를 저장합니다.
    *   템플릿에서 `request.user`를 통해 사용자 정보에 접근합니다.
*   **조건부 렌더링 (Conditional Rendering):**
    *   **내비게이션 메뉴/사이드바:** 사용자의 역할에 따라 접근 권한이 없는 메뉴 항목은 아예 화면에 표시하지 않습니다.
        *   예: 판매점 사용자에게는 '협력사 관리', '본사 설정' 메뉴를 숨김.
    *   **버튼 및 액션:** 특정 작업(생성, 수정, 삭제, 상태 변경 등)을 수행하는 버튼을 권한이 없는 사용자에게는 숨기거나 비활성화(disabled)하여 클릭할 수 없게 만듭니다.
        *   예: 협력사 사용자에게는 다른 협력사를 생성하는 버튼을 숨김.
    *   **데이터 테이블 컬럼/행:** 특정 역할만 볼 수 있는 민감한 정보가 포함된 테이블의 컬럼이나 행을 숨깁니다.
    *   **폼 필드:** 특정 역할만 수정할 수 있는 필드는 읽기 전용으로 표시하거나 숨깁니다.
*   **동적 라우팅/내비게이션 (Dynamic Routing/Navigation):**
    *   Django URL 패턴에서 사용자 권한에 따른 접근 제어를 구현합니다.
    *   뷰에서 `LoginRequiredMixin`과 커스텀 권한 클래스를 사용하여 페이지 접근을 제어합니다.

### 4.3. 역할별 UI 반영 상세

*   **슈퍼계정 (Superuser):**
    *   **UI 반영:** 모든 메뉴 항목, 모든 버튼, 모든 데이터 테이블의 모든 컬럼을 표시합니다. 관리자 대시보드에 대한 완전한 접근 권한을 부여합니다.
*   **본사 계정 (`Company.type = 'headquarters'`에 속한 `CompanyUser`):**
    *   **UI 반영:** 슈퍼계정과 유사하게 대부분의 관리 기능을 제공합니다. '본사 설정'과 같은 특정 메뉴는 본사 계정만 접근 가능하도록 합니다. 다른 계층의 업체 및 사용자 목록을 조회하고 관리할 수 있는 UI 요소를 제공합니다.
    *   **`Company` 생성 정책 반영:** 백엔드 정책에 따라 본사가 판매점을 직접 생성하는 것이 금지될 경우, '새로운 Company 생성' 폼에서 '업체 유형'을 '판매점'으로 선택하는 옵션을 비활성화하거나, 아예 해당 폼 자체를 숨깁니다.
*   **협력사 계정 (`Company.type = 'agency'`에 속한 `CompanyUser`):**
    *   **UI 반영:** '내 협력사 정보', '내 판매점 관리'와 같은 메뉴를 제공합니다. 다른 협력사나 본사 관련 메뉴는 숨기거나 비활성화합니다. 판매점 생성 버튼은 제공하되, 상위 업체 선택 시 자신의 협력사로 자동 지정되거나 선택지가 제한되도록 합니다. 사용자 생성 시, 소속 업체 선택지를 자신의 협력사 또는 하위 판매점으로 제한합니다.
*   **판매점 계정 (`Company.type = 'retail'`에 속한 `CompanyUser`):**
    *   **UI 반영:** '내 판매점 정보', '내 직원 관리'와 같은 최소한의 메뉴만 제공합니다. 다른 업체 관련 메뉴는 모두 숨기거나 비활성화합니다. 사용자 생성 시, 소속 업체 선택지를 자신의 판매점으로 고정합니다.

## 5. 백엔드 API 연동

*   **API 엔드포인트:** 백엔드에서 정의된 RESTful API 엔드포인트(예: `/api/companies/`, `/api/companies/users/`)를 사용하여 데이터를 요청하고 전송합니다.
*   **인증:** 로그인 시 Django 세션 기반 인증을 사용하며, 모든 API 요청에서 사용자 인증 상태를 확인합니다.
*   **오류 처리:** 백엔드에서 반환하는 HTTP 상태 코드(예: 400, 401, 403, 404, 500)와 오류 메시지를 적절히 파싱하여 사용자에게 친화적인 메시지를 표시합니다.
*   **데이터 동기화:** 데이터 변경(생성, 수정, 삭제) 후에는 UI를 업데이트하기 위해 관련 데이터를 다시 로드하거나, 프론트엔드 상태를 직접 업데이트하여 백엔드와의 데이터 일관성을 유지합니다.

### 5.1. AJAX 통신

*   **CSRF 토큰:** Django의 CSRF 보호를 위해 모든 AJAX 요청에 CSRF 토큰을 포함합니다.
*   **JSON 응답:** API 엔드포인트에서 JSON 형태의 응답을 받아 처리합니다.
*   **실시간 피드백:** 사용자 액션에 대한 즉각적인 피드백을 제공합니다.

## 6. 향후 SPA 전환 계획

### 6.1. 단계적 전환

1. **1단계:** 현재 Django 템플릿 기반 시스템 유지
2. **2단계:** API 우선 설계로 백엔드 API 완성
3. **3단계:** SPA 프론트엔드 개발 및 점진적 전환
4. **4단계:** 완전한 SPA 시스템으로 전환

### 6.2. 기술 스택 선택 기준

*   **React:** 대규모 커뮤니티, 풍부한 생태계, TypeScript 지원
*   **Vue.js:** 학습 곡선이 낮고, 점진적 도입 가능
*   **Angular:** 엔터프라이즈급 기능, TypeScript 기본 지원

이 문서는 `DN_solution` 프로젝트의 프론트엔드 애플리케이션을 설계하고 구현하는 데 필요한 상세한 가이드라인을 제공합니다.
